#title dup(2)
[wiki:function_dup(2) HTML 변환문서]

{{{#!plain
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook V4.1//EN">
<chapter lang=ko>
<!-- 작성자 : yundream             -->
<!-- 작성일 : 2002/02/18           -->
<!-- 연락처 : dreamyun@yahoo.co.kr -->

<!-- 함수 이름을 입력합니다 -->
<title>dup(2)</title>

<!-- 이건 함수에 대한 대략적인 설명이구요 -->
<para>
	파일 지정자를 복사한다. 
</para>
 
<!-- 여기에 함수의 간단한 사용법이 들어갑니다 -->
<section>
	<title>사용법</title>
	<para>
		<screen>
#include &lt;unistd.h&gt;

int dup(int oldfd);
int dup2(int oldfd, int newfd);
		</screen>
	</para>
</section>

<!-- 여기엔 함수의 자세한 설명 이 들어갑니다 -->
<section>
	<title>설명</title>
	<para>
		dup()와 dup2()는 파일 지정자 <emphasis>oldfd</emphasis>에 대한 복사본을 
		생성한다. 성공적으로 수행될경우 oldfd 지정자에 대한 복사본은 
		서로 공유되어서 사용된다. 즉 lock, 파일위치 포인터, 플래그등을 
		공유한다. 만약 원본 파일지정자 에서 위치변경이 일어 났다면, 
		다른 복사된 파일지정자에도 영향을 미친다.  
	</para>
	<para>
		그러나 이 두개의 파일지정자간 close-on-exe 플래그는 공유되지 
		않는다. 
	</para>
	<para>
		dup()를 이용해서 복사되어지는 새로운 파일 지정자는 사용되지 않는 
		가장 작은 파일 지정자를 이용한다. dup2()는 디스크립터는 파일 지정자를 
		지정할 수 있는데, 이전에 열린 <emphasis>newfd</emphasis>가 있다면 
		닫고 나서, <emphasis>oldfd</emphasis>를 
		<emphasis>newfd</emphasis>에 복사하면 된다. 
	</para>
</section>

<!-- 함수가 되돌려주는 값이구요 -->
<section>
	<title>반환값</title>
	<para>
		복사된 새로운 파일지정자를 리턴한다. 에러가 발생하면 -1 을 리턴한다. 
	</para>
</section>

<!-- 에러가 발생했을때 되돌려주는 값들입니다 -->
<section>
	<title>에러</title>
	<para>
		<variablelist>	
			<varlistentry>
			<term>EBADF</term>	
			<listitem>
				<para>	
					oldfd 가 열린 파일 지정자가 아닐경우 
				</para>	
			</listitem>
			</varlistentry>

			<varlistentry>
			<term>EMFILE</term>
			<listitem>
				<para>
					프로세스가 최대로 열수 있는 파일 지정자 
					갯수를 가진 상태에서 새로운 파일지정자를 얻고자 
					시도하는 경우 
				</para>
			</listitem>
			</varlistentry>
		</variablelist>	
	</para>
</section>

<!-- 마지막으로 에제 입니다                                                 -->
<!-- 여기에는 완전한 예제가 들어가 있는데, 굳이 완전한 예제를 만들필요 없이 -->
<!-- 코드 일부분만 작성해서 올려주셔도 됩니다                               --> 
<!-- "<", ">", "&" 등은 변환해 주셔야 하는데, 귀찮으시면 :-) 변환 하지 않   -->
<!-- 아도 됩니다. 제가 검사 해서 올리겠습니다                               -->
<!-- 예제에 대한 간단한 설명을 적어주셔도 되구요                            -->
<section>
	<title>예제</title>
	<para>
		<screen>
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;fcntl.h&gt;

int main()
{
    int fd, fd2;
    char buf[80];

    fd = open("dup.c", O_RDONLY);
    fd2 = dup(fd);
    printf("%d = %d\n", fd, fd2);

    memset(buf, 0x00, 80);
    read(fd, buf, 20);
    printf("fd : %d\n%s\n", fd, buf);

    memset(buf, 0x00, 80);
    read(fd2, buf, 20);
    printf("fd : %d\n%s\n", fd2, buf);

    close(fd);
}
		</screen>
	</para>
</section>

<section>
	<title>참고문헌</title>	
	<para>
		<orderedlist>
			<listitem>
				<para>
					<ulink url="http://www.joinc.co.kr/modules.php?name=News&amp;file=article&amp;sid=85">dup 활용</ulink>
				</para>
			</listitem>
		</orderedlist>
	</para>
</section>
</chapter>
}}}
